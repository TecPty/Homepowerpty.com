<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Carousel - Black Week Popup</title>
    <link rel="stylesheet" href="styles/styles.css">
</head>
<body style="padding: 20px; background: #f0f0f0;">
    <h1>Prueba del Carrusel - Black Week Popup</h1>
    
    <div style="max-width: 600px; margin: 20px auto;">
        <!-- Simulación del popup para pruebas -->
        <div class="black-week-popup show" style="position: relative; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
            <div class="popup-content">
                <div class="popup-body">
                    <h3 class="popup-main-title">¡DESCUENTOS INCREÍBLES!</h3>
                    
                    <!-- Carrusel de banners promocionales -->
                    <div class="popup-banners-carousel">
                        <div class="banners-container" id="bannersContainer">
                            <div class="banner-slide active">
                                <img src="media/images/Promocion/Black_Week_Costo.png" alt="Promoción Black Week El Costo" class="promotion-banner">
                                <div class="banner-overlay">
                                    <h4>Promoción El Costo</h4>
                                    <p>15% de descuento en electrodomésticos seleccionados</p>
                                </div>
                            </div>
                            <div class="banner-slide">
                                <img src="media/images/Promocion/Black_Week_Madison.png" alt="Promoción Black Week Madison" class="promotion-banner">
                                <div class="banner-overlay">
                                    <h4>Promoción Madison</h4>
                                    <p>15% de descuento en productos Power</p>
                                </div>
                            </div>
                            <div class="banner-slide">
                                <img src="media/images/Promocion/Black_Week_Titan.png" alt="Promoción Black Week Titan" class="promotion-banner">
                                <div class="banner-overlay">
                                    <h4>Promoción Titan</h4>
                                    <p>15% de descuento en toda la línea</p>
                                </div>
                            </div>
                        </div>
                        <div class="carousel-controls">
                            <button class="carousel-btn prev" id="prevBanner">‹</button>
                            <div class="carousel-indicators" id="carouselIndicators"></div>
                            <button class="carousel-btn next" id="nextBanner">›</button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; text-align: center;">
                        <button onclick="testCarousel()" style="background: var(--color_orange); color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                            Probar Carrusel Manualmente
                        </button>
                        <button onclick="resetLocalStorage()" style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-left: 10px;">
                            Resetear LocalStorage
                        </button>
                        <button onclick="forceShowPopup()" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-left: 10px;">
                            Mostrar Popup Ahora
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div style="max-width: 600px; margin: 20px auto; padding: 20px; background: white; border-radius: 10px;">
        <h3>Estado del Carrusel:</h3>
        <div id="carouselStatus">Cargando...</div>
        
        <h3>Controles de Debug:</h3>
        <button onclick="showCurrentSlide()">Mostrar Slide Actual</button>
        <button onclick="nextSlideDebug()">Siguiente Slide</button>
        <button onclick="prevSlideDebug()">Slide Anterior</button>
        <button onclick="toggleAutoSlide()">Toggle Auto-Slide</button>
    </div>

    <script src="scripts/black_week_popup.js"></script>
    <script>
        // Funciones de debug
        function testCarousel() {
            console.log('Testing carousel...');
            console.log('Current slide:', window.BlackWeekPopup?.currentSlide || 'No disponible');
            console.log('Banner slides:', document.querySelectorAll('.banner-slide').length);
            console.log('Indicators:', document.querySelectorAll('.indicator').length);
        }
        
        function resetLocalStorage() {
            if (window.BlackWeekPopup?.resetStorage) {
                window.BlackWeekPopup.resetStorage();
                console.log('LocalStorage resetado');
            }
        }
        
        function forceShowPopup() {
            if (window.BlackWeekPopup?.forceShow) {
                window.BlackWeekPopup.forceShow();
            } else {
                console.log('BlackWeekPopup no disponible, intentando mostrar directamente');
                // Fallback: buscar el popup y mostrarlo directamente
                const popup = document.getElementById('blackWeekPopup');
                if (popup) {
                    popup.classList.add('active');
                }
            }
        }
        
        function showCurrentSlide() {
            const slides = document.querySelectorAll('.banner-slide');
            const activeSlide = document.querySelector('.banner-slide.active');
            console.log('Total slides:', slides.length);
            console.log('Active slide:', activeSlide ? Array.from(slides).indexOf(activeSlide) : 'none');
            
            document.getElementById('carouselStatus').innerHTML = 
                `Total slides: ${slides.length}<br>
                 Slide activo: ${activeSlide ? Array.from(slides).indexOf(activeSlide) : 'none'}<br>
                 Indicadores: ${document.querySelectorAll('.indicator').length}`;
        }
        
        function nextSlideDebug() {
            const nextBtn = document.getElementById('nextBanner');
            if (nextBtn) nextBtn.click();
        }
        
        function prevSlideDebug() {
            const prevBtn = document.getElementById('prevBanner');
            if (prevBtn) prevBtn.click();
        }
        
        function toggleAutoSlide() {
            console.log('Auto-slide toggle not implemented yet');
        }
        
        // Actualizar estado inicial
        setTimeout(() => {
            showCurrentSlide();
        }, 1000);
        
        // Log de eventos
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('carousel-btn')) {
                console.log('Carousel button clicked:', e.target.className);
            }
        });
    </script>
</body>
</html>